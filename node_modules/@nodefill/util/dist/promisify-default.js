"use strict";
function promisify(f) {
    if (typeof f !== "function") {
        throw new TypeError(`${f} is not a function`);
    }
    if (f[promisify.custom]) {
        const promisified = f[promisify.custom];
        if (typeof promisified !== "function") {
            throw new TypeError(`${promisified} is not a function`);
        }
        return promisified;
    }
    function promisified(...args) {
        return new Promise((resolve, reject) => {
            const callback = (error, value) => {
                if (error) {
                    reject(error);
                }
                else {
                    resolve(value);
                }
            };
            f.call(this, ...args, callback);
        });
    }
    promisified[promisify.custom] = promisified;
    return promisified;
}
promisify["" + "custom"] = Symbol.for("nodejs.util.promisify.custom");
module.exports = promisify;
